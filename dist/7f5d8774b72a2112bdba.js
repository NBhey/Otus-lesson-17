import getCity from"./getUserIp";import saveList from"./localStorage";import{getItem}from"./localStorage";import{countCity}from"./countCity";import"./style/style.css";const API_KEY="fd185eec875c277bc16bccdb3629b6af",titleCity=document.querySelector(".title-city"),city=document.createElement("p");city.classList.add("city");const temperature=document.createElement("p");temperature.classList.add("temperature");const image=document.createElement("img");async function global(){async function t(){const t=await getCity(),e=[];return e.push(t.longitude,t.latitude),e}async function e(t){return city.innerText=await t,temperature.innerText=` ${await async function(t){const e=await t,a=await fetch(`https://api.openweathermap.org/data/2.5/weather?units=metric&q=${e}&appid=${API_KEY}`),n=await a.json();return Math.round(n.main.temp)}(t)} °C `,image.src=`http://openweathermap.org/img/wn/${await async function(t){const e=await t,a=await fetch(`https://api.openweathermap.org/data/2.5/weather?units=metric&q=${e}&appid=${API_KEY}`);return(await a.json()).weather[0].icon}(t)}@2x.png`,titleCity.append(city,temperature,image)}function a(t,a){t.innerHTML=a.map((t=>`<p>${t}</p>`)).join(""),console.log(t),console.log(a);for(let a=0;a<t.children.length;a++)console.log(t.children[a].textContent),t.children[a].addEventListener("click",(n=>{n.preventDefault(),e(t.children[a].textContent)}));console.log(t),console.log(a),5===a.length&&a.splice(0,1)}e(async function(){return(await getCity()).city}()),async function(){await ymaps3.ready;const{YMap:e,YMapDefaultSchemeLayer:a}=ymaps3;new e(document.getElementById("map"),{location:{center:await t(),zoom:10}}).addChild(new a)}();const n=document.querySelector(".input-city"),i=document.querySelector(".btn"),c=document.querySelector("#list"),o=await getItem();a(c,o),i.addEventListener("click",(()=>{let t=n.value.trim();""===t&&alert("Введите значение в поле"),e(t),o.push(t),a(c,o),saveList(o),countCity(c),n.value=""}))}image.classList.add("imageUser"),global();